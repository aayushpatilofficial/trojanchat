<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neura Sync v3.0 Ultimate</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-primary: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #4b5563;
            --border-color: #e5e7eb;
        }
        body.dark-mode {
            --bg-primary: #0f1419;
            --text-primary: #f0f4f8;
            --text-secondary: #a0aac0;
            --border-color: #2d3748;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto; background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 50%, #f9fafb 100%); color: var(--text-primary); min-height: 100vh; transition: all 0.3s ease; }
        body.dark-mode { background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 50%, #252d3d 100%); }
        .sidebar { position: fixed; left: 0; top: 0; width: 280px; height: 100vh; background: var(--bg-primary); border-right: 1px solid var(--border-color); overflow-y: auto; z-index: 1000; display: flex; flex-direction: column; }
        .sidebar-header { padding: 20px 16px; border-bottom: 1px solid var(--border-color); font-weight: 700; font-size: 16px; background: linear-gradient(135deg, #dbeafe 0%, #ede9fe 100%); }
        .sidebar-logo { font-size: 24px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
        .sidebar-nav { flex: 1; padding: 16px 0; overflow-y: auto; }
        .nav-section { padding: 16px 0; border-bottom: 1px solid var(--border-color); }
        .nav-section-title { font-size: 9px; font-weight: 700; text-transform: uppercase; color: var(--text-secondary); padding: 0 16px 12px; }
        .nav-item { padding: 10px 16px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 10px; font-size: 13px; font-weight: 500; }
        .nav-item:hover { background: #f3f4f6; color: var(--primary); }
        .nav-item.active { background: #dbeafe; color: var(--primary); border-left: 4px solid var(--primary); padding-left: 12px; font-weight: 700; }
        .main-content { margin-left: 280px; min-height: 100vh; display: flex; flex-direction: column; }
        .navbar { background: var(--bg-primary); border-bottom: 1px solid var(--border-color); padding: 0 24px; height: 70px; display: flex; align-items: center; position: sticky; top: 0; z-index: 100; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: 20px; }
        .nav-title { font-size: 18px; font-weight: 700; color: var(--gray-900); }
        .nav-right { display: flex; gap: 16px; align-items: center; }
        .status-badge { display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: #f3f4f6; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--danger); }
        .status-dot.active { background: var(--success); box-shadow: 0 0 12px rgba(16, 185, 129, 0.6); }
        .theme-toggle { background: #f3f4f6; border: 1px solid var(--border-color); border-radius: 20px; padding: 8px 14px; cursor: pointer; font-size: 16px; transition: all 0.3s ease; }
        .theme-toggle:hover { background: var(--primary); color: white; transform: scale(1.05); }
        .container { flex: 1; padding: 28px; overflow-y: auto; }
        .page-header { margin-bottom: 28px; }
        .page-header h1 { font-size: 32px; margin-bottom: 8px; font-weight: 800; background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .page-header p { font-size: 14px; color: var(--text-secondary); }
        .section { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 24px; margin-bottom: 20px; }
        .section-title { font-size: 18px; font-weight: 700; color: var(--text-primary); margin-bottom: 16px; }
        .input-group { display: flex; gap: 12px; margin-bottom: 18px; align-items: flex-end; flex-wrap: wrap; }
        .input-wrapper { flex: 1; min-width: 200px; }
        .input-label { font-size: 11px; font-weight: 700; color: var(--text-secondary); margin-bottom: 6px; display: block; text-transform: uppercase; }
        input, textarea, select { width: 100%; padding: 12px 14px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; background: var(--bg-primary); color: var(--text-primary); font-family: inherit; }
        input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .btn { padding: 10px 24px; background: linear-gradient(135deg, var(--primary), #1e40af); color: white; border: none; border-radius: 8px; font-size: 13px; font-weight: 700; cursor: pointer; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 6px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4); }
        .btn-sm { padding: 8px 14px; font-size: 11px; }
        .btn-secondary { background: linear-gradient(135deg, var(--secondary), #7c3aed); }
        .btn-success { background: linear-gradient(135deg, var(--success), #059669); }
        .btn-danger { background: linear-gradient(135deg, var(--danger), #dc2626); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 28px; }
        .stat-card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; display: flex; flex-direction: column; gap: 10px; transition: all 0.2s ease; }
        .stat-card:hover { border-color: var(--primary); box-shadow: 0 12px 24px rgba(59, 130, 246, 0.15); transform: translateY(-6px); }
        .stat-icon { font-size: 28px; }
        .stat-label { font-size: 11px; font-weight: 700; text-transform: uppercase; color: var(--text-secondary); }
        .stat-value { font-size: 32px; font-weight: 800; color: var(--text-primary); }
        .stat-sub { font-size: 12px; color: var(--text-secondary); }
        .cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 16px; }
        .info-card { background: linear-gradient(135deg, #dbeafe, #ede9fe); border: 1px solid #bfdbfe; border-radius: 8px; padding: 18px; color: #0c2d6b; cursor: pointer; transition: all 0.2s ease; }
        .info-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(59, 130, 246, 0.2); }
        .info-card h3 { font-size: 14px; font-weight: 700; margin-bottom: 8px; }
        .info-card p { font-size: 12px; line-height: 1.5; }
        .badge { display: inline-flex; align-items: center; gap: 4px; padding: 5px 10px; background: #dbeafe; color: var(--primary); border-radius: 20px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
        .badge.success { background: #d1fae5; color: var(--success); }
        .page-content { display: none; }
        .page-content.active { display: block; }
        .progress-bar { width: 100%; height: 6px; background: var(--border-color); border-radius: 4px; overflow: hidden; margin-top: 10px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--primary), #0ea5e9); transition: width 0.4s ease; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 2000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: var(--bg-primary); border-radius: 12px; padding: 24px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; }
        .modal-header { font-size: 20px; font-weight: 700; margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center; }
        .modal-close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary); }
        .tabs { display: flex; gap: 10px; border-bottom: 2px solid var(--border-color); margin-bottom: 16px; overflow-x: auto; }
        .tab { padding: 8px 12px; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--text-secondary); border-bottom: 3px solid transparent; transition: all 0.2s ease; font-size: 12px; white-space: nowrap; }
        .tab.active { color: var(--primary); border-bottom-color: var(--primary); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .session-item { background: #f9fafb; padding: 16px; border-radius: 8px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; gap: 12px; border: 1px solid var(--border-color); transition: all 0.2s ease; }
        .session-item:hover { border-color: var(--primary); }
        .session-info { flex: 1; }
        .session-name { font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .session-meta { font-size: 12px; color: var(--text-secondary); }
        .clipboard-item { background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 3px solid var(--primary); display: flex; justify-content: space-between; align-items: center; gap: 12px; }
        .clipboard-text { flex: 1; font-size: 12px; color: var(--text-secondary); word-break: break-all; font-family: monospace; }
        .focus-score { display: flex; align-items: center; justify-content: center; width: 120px; height: 120px; border-radius: 50%; background: conic-gradient(var(--success) var(--focus-percentage), var(--border-color) 0); margin: 20px auto; }
        .focus-score-inner { width: 110px; height: 110px; background: var(--bg-primary); border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .focus-score-value { font-size: 32px; font-weight: 800; }
        .focus-score-label { font-size: 11px; color: var(--text-secondary); }
        .timer-display { font-size: 48px; font-weight: 800; font-family: monospace; color: var(--primary); margin: 20px 0; text-align: center; }
        .timer-controls { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
        .search-box { display: flex; gap: 10px; margin-bottom: 16px; }
        .search-input { flex: 1; min-width: 200px; }
        .search-results { max-height: 400px; overflow-y: auto; }
        .result-item { background: #f9fafb; padding: 12px; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid var(--primary); cursor: pointer; transition: all 0.2s ease; }
        .result-item:hover { transform: translateX(4px); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2); }
        .result-title { font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .result-meta { font-size: 11px; color: var(--text-secondary); }
        .chart-container { height: 300px; display: flex; align-items: flex-end; gap: 12px; justify-content: space-around; margin: 20px 0; }
        .chart-bar { flex: 1; background: linear-gradient(180deg, var(--primary), #1e40af); border-radius: 4px 4px 0 0; min-height: 20px; display: flex; align-items: flex-end; justify-content: center; color: white; font-size: 11px; font-weight: 700; padding-bottom: 8px; }
        .drag-drop-zone { border: 2px dashed var(--primary); border-radius: 8px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.3s ease; margin: 16px 0; }
        .drag-drop-zone:hover { background: rgba(59, 130, 246, 0.05); border-color: #1e40af; }
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .main-content { margin-left: 0; }
            .container { padding: 16px; }
            .stats-grid { grid-template-columns: 1fr; }
            .cards-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">‚ö°</div>
            <div>Neura Sync v3.0</div>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Core</div>
                <div class="nav-item active" onclick="switchPage(event, 'dashboard')">üìä Dashboard</div>
                <div class="nav-item" onclick="switchPage(event, 'commands')">üì§ Commands</div>
                <div class="nav-item" onclick="switchPage(event, 'history')">üìã History</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">v3.0 Features</div>
                <div class="nav-item" onclick="switchPage(event, 'sessions')">üíæ Sessions</div>
                <div class="nav-item" onclick="switchPage(event, 'clipboard')">üìã Clipboard</div>
                <div class="nav-item" onclick="switchPage(event, 'search')">üîç AI Search</div>
                <div class="nav-item" onclick="switchPage(event, 'productivity')">üéØ Productivity</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <div class="nav-item" onclick="switchPage(event, 'settings')">‚öôÔ∏è Settings</div>
            </div>
        </nav>
    </div>

    <div class="main-content">
        <div class="navbar">
            <div class="nav-content">
                <div><div class="nav-title" id="pageTitle">Dashboard</div></div>
                <div class="nav-right">
                    <div class="status-badge">
                        <div class="status-dot active" id="statusDot"></div>
                        <span id="statusText">Connected</span>
                    </div>
                    <button class="theme-toggle" onclick="toggleDarkMode()">üåô</button>
                    <div style="font-size: 11px; color: var(--text-secondary); font-family: monospace;" id="currentTime">00:00:00</div>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- DASHBOARD -->
            <div id="dashboard-page" class="page-content active">
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <p>Multi-device command control with advanced features</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üíæ</div>
                        <div class="stat-label">Saved Sessions</div>
                        <div class="stat-value" id="sessionCount">0</div>
                        <div class="stat-sub">Active sessions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìã</div>
                        <div class="stat-label">Clipboard Items</div>
                        <div class="stat-value" id="clipboardCount">0</div>
                        <div class="stat-sub">Synced items</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-label">Focus Score</div>
                        <div class="stat-value" id="dashFocusScore">85%</div>
                        <div class="stat-sub">Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-label">Session Time</div>
                        <div class="stat-value" id="sessionTime">0:00</div>
                        <div class="stat-sub">This session</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìä Quick Stats</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px;">
                        <div style="background: linear-gradient(135deg, #dbeafe, #ede9fe); padding: 10px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 11px; color: var(--text-secondary);">Commands Today</div>
                            <div style="font-size: 20px; font-weight: 800; color: var(--primary); margin: 3px 0;" id="cmdToday">0</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #dbeafe, #ede9fe); padding: 10px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 11px; color: var(--text-secondary);">Focus Time</div>
                            <div style="font-size: 20px; font-weight: 800; color: var(--primary); margin: 3px 0;" id="focusTime">0h</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #dbeafe, #ede9fe); padding: 10px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 11px; color: var(--text-secondary);">Productivity</div>
                            <div style="font-size: 20px; font-weight: 800; color: var(--primary); margin: 3px 0;" id="productivity">78%</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #dbeafe, #ede9fe); padding: 10px; border-radius: 6px; text-align: center;">
                            <div style="font-size: 11px; color: var(--text-secondary);">Synced Data</div>
                            <div style="font-size: 20px; font-weight: 800; color: var(--primary); margin: 3px 0;" id="syncedData">2.3MB</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SESSIONS -->
            <div id="sessions-page" class="page-content">
                <div class="page-header">
                    <h1>üíæ Tab Session Manager</h1>
                    <p>Save and restore browsing sessions</p>
                </div>
                <div class="section">
                    <div class="section-title">New Session</div>
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label class="input-label">Session Name</label>
                            <input type="text" id="sessionName" placeholder="e.g. Research Project">
                        </div>
                        <button class="btn" onclick="saveSession()">üíæ Save Session</button>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Saved Sessions</div>
                    <div id="sessionsList"></div>
                </div>
            </div>

            <!-- CLIPBOARD -->
            <div id="clipboard-page" class="page-content">
                <div class="page-header">
                    <h1>üìã Cloud Clipboard</h1>
                    <p>Sync clipboard across devices</p>
                </div>
                <div class="section">
                    <div class="section-title">Add to Clipboard</div>
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label class="input-label">Text to Copy</label>
                            <textarea id="clipboardInput" placeholder="Paste text here..." style="height: 80px;"></textarea>
                        </div>
                        <button class="btn" onclick="addToClipboard()">üìã Add</button>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Clipboard History</div>
                    <div id="clipboardList"></div>
                </div>
            </div>

            <!-- AI SEARCH -->
            <div id="search-page" class="page-content">
                <div class="page-header">
                    <h1>üîç AI Universal Search</h1>
                    <p>Search all synced data with AI</p>
                </div>
                <div class="section">
                    <div class="section-title">Search</div>
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchQuery" placeholder="Search tabs, bookmarks, history...">
                        <button class="btn" onclick="performSearch()">üîç Search</button>
                    </div>
                    <div class="search-results" id="searchResults"></div>
                </div>
            </div>

            <!-- PRODUCTIVITY -->
            <div id="productivity-page" class="page-content">
                <div class="page-header">
                    <h1>üéØ Productivity Dashboard</h1>
                    <p>Focus tracking and productivity tools</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-label">Focus Score</div>
                        <div class="stat-value" id="focusScore">85</div>
                        <div class="stat-sub">Out of 100</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-label">Time on Task</div>
                        <div class="stat-value" id="timeOnTask">2h 15m</div>
                        <div class="stat-sub">This week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-label">Distractions</div>
                        <div class="stat-value" id="distractions">3</div>
                        <div class="stat-sub">Today</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">‚è±Ô∏è Pomodoro Timer</div>
                    <div class="timer-display" id="timerDisplay">25:00</div>
                    <div class="timer-controls">
                        <button class="btn btn-success" onclick="startTimer()">‚ñ∂Ô∏è Start</button>
                        <button class="btn btn-secondary" onclick="pauseTimer()">‚è∏Ô∏è Pause</button>
                        <button class="btn btn-danger" onclick="resetTimer()">‚èπÔ∏è Reset</button>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìä Weekly Productivity</div>
                    <div class="chart-container">
                        <div class="chart-bar" style="height: 70%;" title="Mon">70%</div>
                        <div class="chart-bar" style="height: 85%;" title="Tue">85%</div>
                        <div class="chart-bar" style="height: 78%;" title="Wed">78%</div>
                        <div class="chart-bar" style="height: 92%;" title="Thu">92%</div>
                        <div class="chart-bar" style="height: 88%;" title="Fri">88%</div>
                        <div class="chart-bar" style="height: 65%;" title="Sat">65%</div>
                        <div class="chart-bar" style="height: 72%;" title="Sun">72%</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üéì Study Mode</div>
                    <button class="btn btn-success" onclick="enableStudyMode()" style="margin-bottom: 12px;">üìö Enable Study Mode</button>
                    <p style="font-size: 12px; color: var(--text-secondary);">Blocks distracting websites during study sessions</p>
                </div>
            </div>

            <!-- SETTINGS -->
            <div id="settings-page" class="page-content">
                <div class="page-header">
                    <h1>‚öôÔ∏è Settings</h1>
                    <p>Configure preferences</p>
                </div>

                <div class="section">
                    <div class="section-title">Session Settings</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--border-color);">
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Auto-Save Sessions</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Save sessions hourly</div>
                        </div>
                        <input type="checkbox" checked style="width: 20px; height: 20px;">
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--border-color);">
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Cloud Sync</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Sync data across devices</div>
                        </div>
                        <input type="checkbox" checked style="width: 20px; height: 20px;">
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
                        <div>
                            <div style="font-weight: 700; color: var(--text-primary);">Dark Mode</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Enable dark theme</div>
                        </div>
                        <input type="checkbox" id="darkModeToggle" style="width: 20px; height: 20px;">
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Data Management</div>
                    <button class="btn btn-success" onclick="exportData()" style="margin-bottom: 10px; width: 100%; text-align: center;">üì• Export All Data</button>
                    <button class="btn btn-danger" onclick="clearAllData()" style="width: 100%; text-align: center;">üóëÔ∏è Clear All Data</button>
                </div>
            </div>

            <!-- HISTORY -->
            <div id="history-page" class="page-content">
                <div class="page-header">
                    <h1>üìã History & Logs</h1>
                    <p>View all commands and events</p>
                </div>
                <div class="section">
                    <div class="section-title">Activity Log</div>
                    <div id="activityLog" style="max-height: 500px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- COMMANDS -->
            <div id="commands-page" class="page-content">
                <div class="page-header">
                    <h1>üì§ Commands</h1>
                    <p>Send commands to connected devices</p>
                </div>
                <div class="section">
                    <div class="section-title">Send Command</div>
                    <div class="input-group">
                        <div class="input-wrapper">
                            <label class="input-label">Command</label>
                            <input type="text" id="cmdInput" placeholder="Type command...">
                        </div>
                        <button class="btn" onclick="sendCommand()">üì§ Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const state = {
            sessions: [],
            clipboard: [],
            commands: [],
            focusScore: 85,
            pomodoroTime: 1500,
            timerRunning: false,
            activityLog: [],
            commandsToday: 0,
            focusTimeToday: 0,
        };

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        function loadDarkMode() {
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }
        }

        function switchPage(e, page) {
            document.querySelectorAll('.page-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById(page + '-page').classList.add('active');
            e.target.closest('.nav-item').classList.add('active');

            const titles = {
                dashboard: 'Dashboard',
                sessions: 'üíæ Session Manager',
                clipboard: 'üìã Cloud Clipboard',
                search: 'üîç AI Search',
                productivity: 'üéØ Productivity',
                settings: '‚öôÔ∏è Settings',
                history: 'üìã History',
                commands: 'üì§ Commands',
            };
            document.getElementById('pageTitle').textContent = titles[page];
        }

        function saveSession() {
            const name = document.getElementById('sessionName').value;
            if (!name) return alert('Enter session name');

            const session = {
                id: Date.now(),
                name: name,
                tabs: Math.floor(Math.random() * 10) + 1,
                date: new Date().toLocaleDateString(),
                size: (Math.random() * 5 + 0.5).toFixed(1) + 'MB'
            };

            state.sessions.push(session);
            document.getElementById('sessionName').value = '';
            renderSessions();
            updateStats();
            addActivityLog('Session saved: ' + name);
        }

        function renderSessions() {
            const list = document.getElementById('sessionsList');
            if (state.sessions.length === 0) {
                list.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 20px;">No sessions saved</p>';
                return;
            }
            list.innerHTML = state.sessions.map(s => `
                <div class="session-item">
                    <div class="session-info">
                        <div class="session-name">${s.name}</div>
                        <div class="session-meta">${s.tabs} tabs ‚Ä¢ ${s.date} ‚Ä¢ ${s.size}</div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-sm btn-success" onclick="restoreSession(${s.id})">üìÇ Restore</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteSession(${s.id})">üóëÔ∏è Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function restoreSession(id) {
            const session = state.sessions.find(s => s.id === id);
            if (session) {
                alert('Restored session: ' + session.name);
                addActivityLog('Session restored: ' + session.name);
            }
        }

        function deleteSession(id) {
            state.sessions = state.sessions.filter(s => s.id !== id);
            renderSessions();
            updateStats();
        }

        function addToClipboard() {
            const text = document.getElementById('clipboardInput').value;
            if (!text) return alert('Enter text');

            const item = {
                id: Date.now(),
                text: text.substring(0, 50),
                time: new Date().toLocaleTimeString(),
                fullText: text
            };

            state.clipboard.unshift(item);
            if (state.clipboard.length > 20) state.clipboard.pop();
            document.getElementById('clipboardInput').value = '';
            renderClipboard();
            updateStats();
            addActivityLog('Added to clipboard');
        }

        function renderClipboard() {
            const list = document.getElementById('clipboardList');
            if (state.clipboard.length === 0) {
                list.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 20px;">No clipboard items</p>';
                return;
            }
            list.innerHTML = state.clipboard.map(item => `
                <div class="clipboard-item">
                    <div class="clipboard-text">${item.text}...</div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-sm" onclick="copyClipboardItem('${item.fullText.replace(/'/g, "\\'")}')">üìã Copy</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteClipboardItem(${item.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function copyClipboardItem(text) {
            navigator.clipboard.writeText(text);
            alert('Copied to clipboard!');
        }

        function deleteClipboardItem(id) {
            state.clipboard = state.clipboard.filter(item => item.id !== id);
            renderClipboard();
            updateStats();
        }

        function performSearch() {
            const query = document.getElementById('searchQuery').value;
            if (!query) return;

            const results = [
                { type: 'Tab', title: `Tab matching "${query}"`, meta: 'Open in browser' },
                { type: 'Bookmark', title: `Bookmark: ${query} Guide`, meta: 'Saved 2 days ago' },
                { type: 'History', title: `Visited: ${query}.com`, meta: 'Yesterday at 3:45 PM' },
                { type: 'Clipboard', title: `Text: "${query}"`, meta: 'Copied recently' }
            ];

            document.getElementById('searchResults').innerHTML = results.map(r => `
                <div class="result-item">
                    <div class="result-title">${r.type}: ${r.title}</div>
                    <div class="result-meta">${r.meta}</div>
                </div>
            `).join('');

            addActivityLog('Searched for: ' + query);
        }

        let pomodoroInterval = null;

        function startTimer() {
            if (state.timerRunning) return;
            state.timerRunning = true;
            pomodoroInterval = setInterval(() => {
                state.pomodoroTime--;
                updateTimerDisplay();
                if (state.pomodoroTime === 0) {
                    clearInterval(pomodoroInterval);
                    state.timerRunning = false;
                    alert('Pomodoro session complete!');
                    state.pomodoroTime = 1500;
                    updateTimerDisplay();
                }
            }, 1000);
        }

        function pauseTimer() {
            if (pomodoroInterval) {
                clearInterval(pomodoroInterval);
                state.timerRunning = false;
            }
        }

        function resetTimer() {
            if (pomodoroInterval) clearInterval(pomodoroInterval);
            state.timerRunning = false;
            state.pomodoroTime = 1500;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const mins = Math.floor(state.pomodoroTime / 60);
            const secs = state.pomodoroTime % 60;
            document.getElementById('timerDisplay').textContent = 
                `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function enableStudyMode() {
            alert('‚úÖ Study Mode enabled! Distracting sites blocked.');
            addActivityLog('Study Mode enabled');
        }

        function exportData() {
            const data = {
                sessions: state.sessions,
                clipboard: state.clipboard,
                timestamp: new Date().toISOString()
            };
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'neura-sync-backup.json';
            a.click();
            addActivityLog('Data exported');
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è This will delete all data. Continue?')) {
                state.sessions = [];
                state.clipboard = [];
                state.commands = [];
                localStorage.clear();
                renderSessions();
                renderClipboard();
                updateStats();
                addActivityLog('All data cleared');
                alert('‚úÖ All data cleared');
            }
        }

        function sendCommand() {
            const cmd = document.getElementById('cmdInput').value;
            if (!cmd) return alert('Enter command');

            // Send via WebSocket if available, otherwise local execution
            if (typeof socket !== 'undefined' && socket) {
                socket.emit('send_command', {
                    command: cmd,
                    user_id: 'guest'
                });
            }

            // Execute locally
            executeCommand(cmd);
            state.commandsToday++;
            document.getElementById('cmdInput').value = '';
            addActivityLog('Command sent: ' + cmd);
            updateStats();
        }

        function executeCommand(cmd) {
            if (cmd.startsWith('open')) {
                const url = cmd.replace('open ', '').trim();
                const fullUrl = url.startsWith('http') ? url : 'https://' + url;
                window.open(fullUrl, '_blank');
                addActivityLog('Opened: ' + fullUrl);
            } else if (cmd.startsWith('search')) {
                const query = cmd.replace('search ', '').trim();
                window.open('https://www.google.com/search?q=' + encodeURIComponent(query), '_blank');
                addActivityLog('Searched: ' + query);
            }
        }

        function addActivityLog(message) {
            state.activityLog.unshift({
                time: new Date().toLocaleTimeString(),
                message: message
            });
            if (state.activityLog.length > 50) state.activityLog.pop();
            renderActivityLog();
        }

        function renderActivityLog() {
            const log = document.getElementById('activityLog');
            if (!log) return;
            log.innerHTML = state.activityLog.map(entry => `
                <div style="padding: 8px 0; border-bottom: 1px solid var(--border-color); display: flex; gap: 12px; font-size: 12px;">
                    <span style="color: var(--text-secondary); font-family: monospace; min-width: 60px;">${entry.time}</span>
                    <span style="color: var(--text-primary);">${entry.message}</span>
                </div>
            `).join('');
        }

        function updateStats() {
            document.getElementById('sessionCount').textContent = state.sessions.length;
            document.getElementById('clipboardCount').textContent = state.clipboard.length;
            document.getElementById('cmdToday').textContent = state.commandsToday;
            document.getElementById('syncedData').textContent = ((state.sessions.length * 1.2 + state.clipboard.length * 0.05).toFixed(1)) + 'MB';
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', { hour12: false });
        }

        // WebSocket Setup
        let socket = null;

        function initSocket() {
            try {
                socket = io(window.location.origin || 'http://localhost:5000', {
                    reconnection: true,
                    reconnectionDelay: 1000,
                    reconnectionDelayMax: 5000,
                    reconnectionAttempts: 5
                });

                socket.on('connect', () => {
                    console.log('‚úì Connected to server');
                    addActivityLog('Connected to server');
                    document.getElementById('statusDot').classList.add('active');
                    document.getElementById('statusText').textContent = 'Connected';
                });

                socket.on('disconnect', () => {
                    console.log('‚úó Disconnected from server');
                    addActivityLog('Disconnected from server');
                    document.getElementById('statusDot').classList.remove('active');
                    document.getElementById('statusText').textContent = 'Disconnected';
                });

                socket.on('command_ack', (data) => {
                    console.log('‚úì Command acknowledged:', data);
                    addActivityLog('Command executed: ' + data.message);
                });

                socket.on('command_received', (data) => {
                    console.log('üì® Command received:', data);
                    executeCommand(data.command);
                    addActivityLog('Command received: ' + data.command);
                });

                socket.on('error', (error) => {
                    console.error('Socket error:', error);
                    addActivityLog('Error: ' + error.message);
                });
            } catch (e) {
                console.log('WebSocket not available, running in local mode');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadDarkMode();
            updateTime();
            updateTimerDisplay();
            renderSessions();
            renderClipboard();
            renderActivityLog();
            updateStats();
            addActivityLog('Neura Sync v3.0 initialized');
            initSocket();
            setInterval(updateTime, 1000);
        });
    </script>
</body>
</html>